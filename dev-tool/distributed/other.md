分布式系统设计中的两大思路：

* 中心化
* 去中心化。

## 中心化

中心化的设计思想很简单，分布式集群中的节点器按照角色分工，大体上分为两种角色：Leader和Worker。Leader通常负责分发任务并监督Worker，让Worker一直在执行任务；如果Leader发现某个Worker因意外状况不能正常执行任务，则将该Worker从Worker队列去除，并将其任务分给其他Worker。基于容器技术的微服务架构Kubernetes就恰好采用了这一设计思路。

在分布式中心化的设计思路中，还有一种设计思路与编程中敏捷开发的思路类似，即充分相信每个Worker，Leader只负责任务的生成而不再指派任务，由每个Worker自发领任务，从而避免让个别Worker执行的任务过多，并鼓励能者多劳。

中心化设计存在的最大问题是Leader的安全问题，如果Leader出了问题，则整个集群崩溃。但我们难以同时安排两个Leader以避免单点问题。为了解决这个问题，大多数中心化系统都采用了主备两个Leader的设计方案，可以是热备或者冷备，也可以是自动切换或者手动切换，而且越来越多的新系统都具备了自动选举切换Leader的能力，以提升系统的可用性。中心化设计还存在另外一个潜在的问题，即Leader的能力问题，如果系统设计和实现得不好，问题就会卡在Leader身上。

## 去中心化

去中心化设计的核心是在整个分布式系统中不存在一个区别于其他节点的Leader，因此不存在单点故障问题，但由于不存在Leader，所以每个节点都需要与其他（所有）节点对话才能获取必要的集群信息，而分布式系统通信的不可靠性大大增加了上述功能的实现难度。

去中心化设计中最难解决的一个问题是“脑裂”问题，这种情况的发生概率很低，但影响很大。脑裂指一个集群由于网络的故障，被分为至少两个彼此无法通信的单独集群，此时如果两个集群各自工作，则可能会产生严重的数据冲突和错误。一般的设计思路是，当集群判断发生了脑裂问题时，规模较小的集群就“自杀”或者拒绝服务。


实际上，完全意义的真正去中心化的分布式系统并不多见。相反，在外部看来去中心化但工作机制采用了中心化设计思想的分布式系统不断出现。在这种架构下，集群中的Leader是被动态选择出来的，而不是人为预先指定的，而且在集群发生故障的情况下，集群的成员会自发地举行“会议”选举新的Leader主持工作。最典型的案例就是ZooKeeper及用Go实现的Etcd。